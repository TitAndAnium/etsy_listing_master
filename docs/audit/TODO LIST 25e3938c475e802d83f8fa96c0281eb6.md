# TODO LIST

1. **Authenticatie afdwingen op alle API-endpoints – *Owner:* Security Engineer.** *Inspanning:* laag (≤1 dag). Implementeer een auth check middleware voor de functies `api_generateListingFromDump` etc. Dit kan door ID-token validatie zoals al gedaan in `handleGetUserCredits`. Test scenario: ongeauthenticeerde call moet 401 geven.
2. **Persistente creditadministratie implementeren – *Owner:* Backend/Database Engineer.** *Inspanning:* middel (2–3 dagen). Vervang de in-memory `mem` store door Firestore reads/writes. Voeg in `ensureCredits` een fetch toe van bijv. `/usage/{uid}` doc (met datum-gescheiden subcollectie of daily document) en in `consumeCredits` een transaction die het veld `used` increment. Hiermee blijven credits over function restarts consistent. Inclusief migratie: initialiseer bij eerste gebruik op basis van DEFAULT_USER_CREDITS.
3. **Stripe betalingsvalidatie verbeteren – *Owner:* Payments Specialist / Backend.** *Inspanning:* laag (≤1 dag). Pas `handleCreateCheckoutSession` aan zodat het aantal credits niet klakkeloos uit de request komt. Bijv. laat de client alleen het gewenste pakket-ID sturen, en bepaal server-side de prijs & credit aantal. Of cross-check `amount_cents` vs. `credits` op basis van bekende pakketprijzen (zie Masterdoc sectie 6.2/6.3 voor prijzen). Test: probeer via cURL mismatches te posten – de server moet dit weigeren (400).
4. **Firestore Security Rules finalize & testen – *Owner:* Data Protection Officer / Backend Engineer.** *Inspanning:* middel (1–2 dagen). Ga alle regels in `firestore.rules` na en beperk ze conform least privilege. Met name: `users/{userId}` alleen lezen/schrijven door `uid == userId`, logs alleen door admin accounts (bv. via custom claim `admin == true` zoals al gedeeltelijk voorzien), `prompt_versions` eventueel read-only voor iedereen (of zelfs bundelen in config). Nadat je de regels aanscherpt, voer Firestore emulator tests uit: schrijf scripts die proberen verboden acties (bv. andere user’s data lezen) – deze moeten *denied* worden.
5. **E2E test van volledige user journey – *Owner:* QA Lead.** *Inspanning:* middel (2 dagen). Zodra bovenstaande fixes erin zitten, voer een end-to-end test uit: van registratie/login (als van toepassing) tot het kopen van credits en genereren van een listing. Controleer of credits werkelijk afnemen per actie en niet onder de 0 gaan, of errors correct getoond worden. Deze test verzekert dat alle subsystemen samenhangend werken in een productiescenario.
6. **Documentatie-update (Addendum & README) – *Owner:* Product/Delivery Lead.** *Inspanning:* laag (≤1 dag). Werk de docs bij om de laatste wijzigingen te reflecteren: bijv. voeg toe dat auth nu verplicht is voor AI-calls, dat Firestore regels zijn aangescherpt, enz. Zorg dat het *Masterdocument* en *Project_Overview* up-to-date blijven, zodat toekomstige ontwikkelaars de nieuwste beslissingen zien. Ook is een beknopte **README.md** voor externe lezers handig (installatie, .env setup, run/test instructies).
7. **Deploymentstrategie beslissen en uitvoeren – *Owner:* DevOps Engineer.** *Inspanning:* middel (1–2 dagen). Kies de hosting voor de Vue frontend (bijv. Firebase Hosting vs. Vercel) en configureer CI/CD daarvoor. Splits eventueel de build (nu geen aparte frontend directory in repo, dus wellicht is alles in één Firebase project). Stel environment-specific settings in (.env.production vs .env.local bijv.). Deployment moet reproducerbaar en geautomatiseerd worden (denk aan GitHub Actions uitbreiding voor deploy na tests).
8. **Post-release monitoring inrichten – *Owner:* DevOps / Security.** *Inspanning:* laag (≤1 dag). Zet alerts op voor belangrijke metrics: budget bijna op, uitzonderingsfouten in Cloud Functions (via Google Cloud logging alerts), en Slack-notificaties voor critical events. Dit is meer operationeel, maar zou vóór of net na oplevering geregeld moeten zijn om een betrouwbare dienstverlening te garanderen.

*(NB: Bovenstaande taken 1–4 beschouwen we als **blokkerend** voor release (ernst Hoog); taken 5–8 zijn essentieel voor kwaliteit maar zouden de productie niet direct in gevaar brengen als ze iets later komen.)*

[Uitvoertaken Afvinklijst (voor Cascade)](Uitvoertaken%20Afvinklijst%20(voor%20Cascade)%2025e3938c475e807eadb8c8580b3415a7.md)